<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReVive Assessoria - Prevenção Contra Golpes</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Estilo customizado para usar a fonte Inter */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Efeito de hover sutil nos cards */
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        /* Animação do spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #09f;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Cabeçalho -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white shadow-lg">
        <div class="container mx-auto px-6 py-12 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">ReVive Assessoria</h1>
            <p class="text-lg md:text-xl text-indigo-200">Prevenção e Suporte Contra Golpes Digitais.</p>
        </div>
    </header>

    <!-- Conteúdo Principal com os Módulos -->
    <main class="container mx-auto p-4 md:p-8">
        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">

            <!-- 1. Assistente Conversacional Pós-Golpe -->
            <div class="bg-white p-6 rounded-xl shadow-md transition-all duration-300 feature-card">
                <h2 class="text-2xl font-bold text-blue-600 mb-3">Sofri um golpe, e agora?</h2>
                <p class="text-gray-600 mb-4">Se você foi vítima de uma fraude, nosso assistente virtual irá te guiar com um passo a passo personalizado para agir rápido.</p>
                <button class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                    Iniciar Assistente
                </button>
            </div>

            <!-- 2. Simulador de Risco com IA (Funcionalidade com Gemini) -->
            <div class="bg-white p-6 rounded-xl shadow-md transition-all duration-300 feature-card">
                <h2 class="text-2xl font-bold text-blue-600 mb-3">Simulador de Risco</h2>
                <p class="text-gray-600 mb-4">Recebeu uma mensagem suspeita? Cole o texto aqui e nossa IA irá analisar os riscos para você.</p>
                <textarea id="message-input" class="w-full h-24 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Cole o e-mail, SMS ou mensagem de WhatsApp aqui..."></textarea>
                <button id="analyze-button" class="w-full mt-3 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center space-x-2">
                    <span>✨</span>
                    <span>Analisar Mensagem</span>
                </button>
                <div id="analysis-result" class="mt-4"></div>
            </div>

            <!-- 3. Detector de Golpes Visuais -->
            <div class="bg-white p-6 rounded-xl shadow-md transition-all duration-300 feature-card">
                <h2 class="text-2xl font-bold text-blue-600 mb-3">Detector Visual de Golpes</h2>
                <p class="text-gray-600 mb-4">Envie um print de um boleto, QR Code ou comprovante suspeito. Nossa IA verificará se há sinais de fraude.</p>
                <label for="file-upload" class="cursor-pointer w-full inline-block bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-4 rounded-lg text-center">
                    Selecionar Imagem
                </label>
                <input id="file-upload" type="file" class="hidden" />
            </div>

            <!-- 4. Linha do Tempo Interativa -->
            <div class="bg-white p-6 rounded-xl shadow-md transition-all duration-300 feature-card">
                <h2 class="text-2xl font-bold text-blue-600 mb-3">Linha do Tempo de Recuperação</h2>
                <p class="text-gray-600 mb-4">Veja como o tempo de reação é crucial. Arraste a barra para entender suas chances de recuperar o dinheiro.</p>
                <input type="range" min="1" max="48" value="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                <div class="text-center mt-3 font-semibold text-lg text-blue-700">Chance de Recuperação: <span id="chance-valor">80%</span></div>
            </div>

            <!-- 5. FAQ Inteligente -->
            <div class="bg-white p-6 rounded-xl shadow-md transition-all duration-300 feature-card">
                <h2 class="text-2xl font-bold text-blue-600 mb-3">FAQ Inteligente</h2>
                <p class="text-gray-600 mb-4">Tem alguma dúvida? Pergunte diretamente para nossa IA e obtenha respostas na hora.</p>
                <input type="text" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Ex: Preciso fazer B.O.?">
                 <button class="w-full mt-3 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                    Perguntar
                </button>
            </div>
            
            <!-- 6. Gerador de Infográfico Personalizado -->
            <div class="bg-white p-6 rounded-xl shadow-md transition-all duration-300 feature-card">
                <h2 class="text-2xl font-bold text-blue-600 mb-3">Infográfico Personalizado</h2>
                <p class="text-gray-600 mb-4">Responda um questionário rápido e receba um guia de prevenção focado no seu perfil e nos seus hábitos.</p>
                <button class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                    Gerar Meu Guia
                </button>
            </div>

            <!-- 7. Formulário de Relato de Novos Golpes -->
            <div class="bg-white p-6 rounded-xl shadow-md transition-all duration-300 feature-card md:col-span-2 xl:col-span-1">
                <h2 class="text-2xl font-bold text-blue-600 mb-3">Relate um Novo Golpe</h2>
                <p class="text-gray-600 mb-4">Ajude a comunidade! Descreva um golpe que você identificou para mantermos nossa base de dados atualizada.</p>
                <form class="space-y-3">
                    <input type="text" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Tipo de golpe">
                    <textarea class="w-full h-20 p-2 border border-gray-300 rounded-lg" placeholder="Descreva o golpe..."></textarea>
                    <button type="submit" class="w-full bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                        Enviar Relato
                    </button>
                </form>
            </div>

        </div>
    </main>

    <!-- Rodapé -->
    <footer class="text-center py-8">
        <p class="text-gray-500">Projeto de código aberto. Feito para a comunidade.</p>
    </footer>

    <!-- JavaScript com a lógica da API Gemini -->
    <script>
        const analyzeButton = document.getElementById('analyze-button');
        const messageInput = document.getElementById('message-input');
        const analysisResult = document.getElementById('analysis-result');

        // Função para chamar a API com retentativa exponencial
        async function fetchWithExponentialBackoff(url, options, retries = 5, delay = 1000) {
            try {
                const response = await fetch(url, options);
                if (!response.ok) {
                    if (response.status === 429 && retries > 0) {
                        console.warn(`Throttled. Retrying in ${delay}ms... (${retries} retries left)`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                        return fetchWithExponentialBackoff(url, options, retries - 1, delay * 2);
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            } catch (error) {
                console.error("Fetch error:", error);
                if (retries > 0) {
                    console.warn(`Fetch failed. Retrying in ${delay}ms... (${retries} retries left)`);
                    await new Promise(resolve => setTimeout(resolve, delay));
                    return fetchWithExponentialBackoff(url, options, retries - 1, delay * 2);
                } else {
                    throw error;
                }
            }
        }

        const analisarRisco = async () => {
            const userText = messageInput.value.trim();
            if (!userText) {
                analysisResult.innerHTML = `<p class="text-red-600 font-semibold">Por favor, insira uma mensagem para ser analisada.</p>`;
                return;
            }

            analysisResult.innerHTML = `
                <div class="flex flex-col items-center justify-center">
                    <div class="spinner"></div>
                    <p class="mt-2 text-gray-600">Analisando com a IA...</p>
                </div>`;
            analyzeButton.disabled = true;

            const systemPrompt = `Você é um especialista em segurança digital e detecção de fraudes. Sua tarefa é analisar o texto fornecido pelo usuário e identificar sinais de golpe. Responda APENAS com um objeto JSON válido, sem formatação de markdown. O objeto JSON deve ter a seguinte estrutura: {"classificacao": "Seguro" | "Suspeito" | "Possível Golpe", "justificativa": "Uma explicação concisa do porquê desta classificação, apontando os sinais encontrados.", "recomendacao": "Uma ação clara que o usuário deve tomar."}`;

            const apiKey = ""; // A chave será injetada pelo ambiente de execução
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{
                    parts: [{ text: userText }]
                }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
                generationConfig: {
                    responseMimeType: "application/json",
                }
            };

            try {
                const result = await fetchWithExponentialBackoff(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const candidate = result.candidates?.[0];
                if (candidate && candidate.content?.parts?.[0]?.text) {
                    const parsedJson = JSON.parse(candidate.content.parts[0].text);
                    displayResult(parsedJson);
                } else {
                     throw new Error("Resposta da API inválida ou vazia.");
                }

            } catch (error) {
                console.error('Erro ao chamar a API Gemini:', error);
                analysisResult.innerHTML = `<p class="text-red-600 font-semibold">Ocorreu um erro ao analisar a mensagem. Tente novamente mais tarde.</p>`;
            } finally {
                analyzeButton.disabled = false;
            }
        };

        const displayResult = (data) => {
            let bgColor, textColor, title;
            switch (data.classificacao) {
                case 'Possível Golpe':
                    bgColor = 'bg-red-100';
                    textColor = 'text-red-800';
                    title = '❌ Possível Golpe';
                    break;
                case 'Suspeito':
                    bgColor = 'bg-yellow-100';
                    textColor = 'text-yellow-800';
                    title = '⚠️ Suspeito';
                    break;
                case 'Seguro':
                default:
                    bgColor = 'bg-green-100';
                    textColor = 'text-green-800';
                    title = '✅ Seguro';
                    break;
            }

            analysisResult.innerHTML = `
                <div class="${bgColor} ${textColor} p-4 rounded-lg">
                    <h3 class="font-bold text-lg mb-2">${title}</h3>
                    <p class="font-semibold">Justificativa:</p>
                    <p class="mb-2">${data.justificativa}</p>
                    <p class="font-semibold">Recomendação:</p>
                    <p>${data.recomendacao}</p>
                </div>
            `;
        };

        analyzeButton.addEventListener('click', analisarRisco);
    </script>
</body>
</html>
